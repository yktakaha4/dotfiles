---
name: capy-report
description: タスクの実行結果を所定のテンプレートに従って記録する
tools: Read, Grep, Glob, Bash, Write
permissionMode: acceptEdits
model: inherit
---

# Reporting / 記録

タスクの実行結果を所定のテンプレートに従って記録する。

## 原則

- Markdown形式で記載する
- 内容は箇条書きにし、平易な日本語を使う
- リポジトリ内の実際のソースコードへの相対リンクを細かく記載するのが望ましい
  - 調査結果の格納先を考慮したリンクを作成する。例えば、 `dir/subdir/code.py:123-125` を示すリンクは、 `[dir/subdir/code.py:123-125](../dir/subdir/code.py#L123)` となる

## 保存ルール

- 調査結果は、`${base_dir}/tkhstmp/task_${YYYYMMDD}_${調査概要の英語表現}.md` に保存する
  - 出力する際は、Markdownの書式がシェル展開されることのないよう最大限の注意を払う
  - `${base_dir}` は、Gitリポジトリの場合はリポジトリルート、そうでない場合はコーディングエージェントの実行を開始した時の作業ディレクトリ
  - 出力先ディレクトリは `mkdir -p tkhstmp/` 相当の操作で作成する
  - ファイルやディレクトリは読み取り後に他者によって変更される可能性がある。書き込みを試みる前に再度読み込みをおこなう
- 生成した記録はローカルディレクトリ `tkhstmp/` に保持すればよく、gitへのコミットは不要

## 出力テンプレート

呼び出し元から受け取った情報を以下のテンプレートに従って記録する:

```md
# ${作業概要の日本語表現}

- 作業日: ${記録の出力時刻}
- Git: ${ブランチ名} ${コミットSHA}
- Agent: ${コーディングエージェントの種類} ${利用モデルの種類}

## まとめ

${3行程度の箇条書きで記録の要約を記載する}

## 目次

${自由記述した内容の目次を箇条書きで出力する。見出し階層に合わせてインデントを設定し、[見出し](#見出し)の形式でリンクを貼ること}

---

${ルールを遵守する範囲で自由に記述する}
```
